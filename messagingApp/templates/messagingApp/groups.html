{% extends 'base.html' %}
{% block title %}Groups{% endblock %}
{% block extra_css %}
<style>
  .grp-shell { max-width:950px; margin:0 auto; }
  .grp-card { border:1px solid #e5e7eb; border-radius:22px; overflow:hidden; background:#fff; }
  .grp-header { background:linear-gradient(45deg,var(--accent),#4facfe); color:#fff; padding:18px 26px; display:flex; align-items:center; justify-content:space-between; }
  .grp-header h1 { font-size:1.1rem; font-weight:600; margin:0; display:flex; align-items:center; gap:10px; }
  .grp-list { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:18px; padding:26px; }
  .grp-item { position:relative; background:#f8faff; border:1px solid #e6ecf3; border-radius:18px; padding:16px 18px 46px; display:flex; flex-direction:column; gap:10px; text-decoration:none; color:inherit; transition:background .25s, transform .25s, box-shadow .25s; }
  .grp-item:hover { background:#ffffff; transform:translateY(-4px); box-shadow:0 8px 20px rgba(0,0,0,.06); }
  .grp-name { font-weight:600; font-size:.95rem; line-height:1.2; }
  .grp-meta { font-size:.65rem; letter-spacing:.5px; text-transform:uppercase; color:#64748b; }
  .grp-footer { position:absolute; left:0; right:0; bottom:0; display:flex; justify-content:space-between; align-items:center; padding:6px 14px 10px; font-size:.65rem; color:#576273; }
  .grp-empty { padding:80px 30px; text-align:center; color:#7a8495; }
  .grp-empty i { font-size:54px; display:block; margin-bottom:14px; opacity:.7; }
  .grp-actions { display:flex; gap:10px; }
  @media (max-width:680px){ .grp-list { grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); padding:20px; gap:14px; } }
</style>
{% endblock %}
{% block content %}
<div class="grp-shell mt-3">
  <div class="grp-card shadow-sm">
    <div class="grp-header">
      <h1><i class="bi bi-people-fill"></i> Groups</h1>
      <div class="grp-actions">
        {% if user.role in 'teacher admin' %}<a href="{% url 'create_group' %}" class="role-btn"><span><i class="bi bi-plus-circle"></i> New Group</span></a>{% endif %}
        <a href="{% url 'inbox' %}" class="role-btn"><span><i class="bi bi-chat-dots"></i> Inbox</span></a>
      </div>
    </div>
    {% if memberships %}
      <div class="grp-list">
        {% for m in memberships %}
          <a href="{% url 'group_chat' m.group.id %}" class="grp-item">
            <div class="grp-name">{{ m.group.name }}</div>
            <div class="grp-meta">Created {{ m.group.created_at|date:"M d, Y" }}</div>
            <div class="grp-footer">
              <span>{{ m.group.messages.count }} messages</span>
              <span>{{ m.group.memberships.count }} members</span>
            </div>
          </a>
        {% endfor %}
      </div>
    {% else %}
      <div class="grp-empty">
        <i class="bi bi-people"></i>
        <p>No groups yet. {% if user.role in 'teacher admin' %}Create the first one!{% endif %}</p>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
