{% extends "base.html" %}
{% block title %}Classes{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Classes</h2>
  <div class="d-flex gap-2">
    <a class="role-btn" href="{% url 'admin_subjects_list' %}"><span><i class="bi bi-eye"></i> View Subjects</span></a>
    <a class="role-btn" href="{% url 'admin_class_create' %}"><span>+ New Class</span></a>
  </div>
</div>

<div class="card p-0">
  <div class="table-responsive">
  <table class="table table-modern table-hover align-middle mb-0" id="classesTable">
    <thead>
      <tr>
        <th>Name</th>
        <th>Section</th>
        <th>Capacity</th>
        <th>Students</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for c in object_list %}
      <tr class="class-row" data-href="{% url 'class_detail' c.pk %}" tabindex="0" aria-label="View class {{ c.name }} {{ c.section }} details">
        <td>{{ c.name }}</td>
        <td>{{ c.section }}</td>
        <td>{{ c.capacity }}</td>
        <td>{{ c.num_students|default:0 }}</td>
        <td class="text-end">
          <a class="role-btn" href="{% url 'admin_class_edit' c.pk %}"><span><i class="bi bi-pencil"></i> Edit</span></a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-center">No classes yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
</div>
    <div class="d-flex gap-2 mt-4">
  {% load dashboard_tags %}
  <a class="role-btn" href="{% dashboard_url %}"><span>‚Üê Back</span></a>
    </div>

<style>
  #classesTable tbody tr.class-row { cursor:pointer; }
  #classesTable tbody tr.class-row:focus { outline:2px solid var(--accent,#1875FF); outline-offset:-2px; }
</style>
<script>
  (function(){
    const rows = document.querySelectorAll('#classesTable tbody tr.class-row');
    rows.forEach(r => {
      r.addEventListener('click', e => {
        if(e.target.closest('a, button')) return; // don't hijack clicks on buttons/links
        const url = r.getAttribute('data-href');
        if(url) window.location = url;
      });
      r.addEventListener('keydown', e => {
        if(e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          const url = r.getAttribute('data-href');
          if(url) window.location = url;
        }
      });
    });
  })();
</script>
{% endblock %}
